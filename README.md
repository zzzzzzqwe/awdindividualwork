# Индивидуальная работа. Разработка новостного веб-приложения с аутентификацией

## Студенты
**Gachayev Dmitrii I2302**  
**Maximenco Stanislav I2302**

**Выполнено 03.05.2025**  

## Цель работы
Целью работы является разработка защищённого веб-приложения с аутентификацией, взаимодействием с базой данных, управлением пользовательскими ролями и возможностью взаимодействия с контентом через формы.


## Описание работы
Данная работа представляет собой веб-приложение, разработанное с использованием языка PHP в качестве бэкенда, HTML,CSS, JS в качестве фронтенда и СУБД PostgreSQL. Основная задача — управление пользователями и новостным контентом с разграничением прав доступа. Приложение реализует регистрацию и вход пользователей с безопасным хешированием паролей, проверкой данных и защитой от SQL-инъекций. Интерфейс приложения делится на общедоступную и защищённую части. Авторизованные пользователи могут просматривать записи, а администраторы получают доступ к расширенному функционалу: управлению пользователями и созданию, редактированию и удалению контента. Формы обладают как клиентской, так и серверной валидацией и обеспечивают защиту от некорректных данных. Работа построена по модульному принципу и легко масштабируется.

## Запуск и установка
1. Для работы проекта необходимо установить `PostgreSQL`, создать базу данных, например, `adwli` и повторить архитектуру базы данных:
```sql
CREATE TABLE IF NOT EXISTS users (
    id integer NOT NULL,
    username character varying(50) NOT NULL,
    email character varying(100) NOT NULL,
    password_hash text NOT NULL,
    role character varying(20) DEFAULT 'user'::character varying,
    created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE IF NOT EXISTS content (
    id integer NOT NULL,
    title character varying(255) NOT NULL,
    body text NOT NULL,
    created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    category character varying(100),
    is_public boolean DEFAULT true,
    author character varying(100)
);
```
2. Настроить подключение к базе данных, изменив конфигурационный файл `config/config.php`:
```php
<?php
function getPDO(): PDO {
    return new PDO("pgsql:host=localhost;port=YOUR_PORT;dbname=YOUR_DATABASE_NAME", "YOUR_LOGING", "YOUR_PASSWORD", [
        PDO::ATTR_ERRMODE => PDO::ERRMODE_EXCEPTION
    ]);
}
```
3. Открыть командную строку в папке проекта и выполнить команду:
```bash
php -S localhost:8000 -t public
```

4. Перейти на `localhost:8000/register.php`

## Документация проекта
### 1. Функциональные возможности
- Регистрация и вход пользователей с безопасным хешированием пароля (через `password_hash()` и `password_verify()`)
- Роли пользователей: **пользователь** и **администратор**
- Доступ к контенту:
  - Пользователи могут просматривать публичные записи (новости)
  - Администраторы могут создавать, редактировать, удалять записи и просматривать приватные записи
  - Также администраторы могут манипулировать пользователями: создавать, удалять, выдавать/забирать админ права
- Поиск и фильтрация контента по:
  - Заголовку
  - Автору
  - Категории
- Валидация данных на клиенте и сервере
- Защита от SQL-инъекций (через PDO `prepare`/`execute`)
- Проверка уникальности указываемых логинов и почт, в том числе при создании администратором
- Все манипуляции отображаются в базе данных

### 2. Сценарии взаимодействия пользователей с приложением

#### Незарегистрированный пользователь
- Не может ничего просматривать (происходит редирект на `login` при попытке насильно перейти в `dashboard`)
- Может перейти на страницу регистрации или входа

#### Зарегистрированный пользователь
- Входит в систему
- Получает доступ к панели (`dashboard`)
- Может просматривать все публичные записи (новости)

#### Администратор
- Входит в защищённый раздел
- Управляет пользователями (создание, назначение ролей, удаление)
- Управляет контентом (создание, редактирование, удаление)
- Имеет доступ к административным страницам (`/admin/users.php`, `/admin/create_user.php`.)

#### Структура базы данных

Таблица `users`
| Поле         | Тип           | Назначение                        |
|--------------|----------------|-----------------------------------|
| `id`         | `serial`       | Первичный ключ                   |
| `username`   | `varchar(100)` | Уникальное имя пользователя      |
| `email`      | `varchar(100)` | Уникальный email                 |
| `password_hash` | `text`      | Хеш пароля                       |
| `role`       | `varchar(10)`  | Роль (`user` или `admin`)       |
| `created_at` | `timestamp`    | Дата регистрации                 |

Таблица `content`
| Поле         | Тип           | Назначение                        |
|--------------|----------------|-----------------------------------|
| `id`         | `serial`       | Первичный ключ                   |
| `title`      | `varchar(100)` | Заголовок записи                 |
| `body`       | `text`         | Текст записи                     |
| `category`   | `varchar(50)`  | Категория (`Новости`, `Статьи`…)|
| `is_public`  | `boolean`      | Публичность записи               |
| `author`     | `varchar(100)` | Имя автора                       |
| `created_at` | `timestamp`    | Дата создания                    |

---